<section class="service-listing">
    <div class="container">
        <div class="row">
            <div class="col-12 col-lg-3">
                <ul class="list list--pills d-none d-md-block mb-4">
                    {% for service_type in service_types %}
                        <li class="list__item">
                            <a class="list__link text-sm text-md-base" href="#{{ service_type.slug }}">
                                {{ service_type.name }} {{ 'service' in service_type.name ?: __('services' , 'expedition') }}
                                {{ fetch_svg('chevron-right') }}
                            </a>
                        </li>
                    {% endfor %}
                    <li class="list__item">
                        <a class="list__link text-sm text-md-base" href="#certification_services">
                            {{ __('Certification services' , 'expedition') }}
                            {{ fetch_svg('chevron-right') }}
                        </a>
                    </li>
                </ul>

                <div class="d-md-none">
                    <select name="test" id="test" class="js-service-select service-listing__select">
                        {% for service_type in service_types %}
                            <option value="{{ service_type.slug }}">{{ service_type.name }}</option>
                        {% endfor %}
                        <option value="certification_services">{{ __('Certification services' , 'expedition') }}</option>
                    </select>
                </div>
            </div>
            <div class="col-12 col-lg-9">
                {% set title = '' %}
                {% for service_type in service_types %}
                    <div class="row service-listing__row" id="{{ service_type.slug }}">
                        {% if title != service_type.name %}
                            {% set title = service_type.name %}
                            <div class="col-12 d-flex justify-content-between align-items-center mb-6 mb-md-8">
                                <h2 class="text-xl text-md-3xl service-listing__title">
                                    {{ fetch_svg(service_type.icon) }}
                                    {{ title }}
                                </h2>

                                {% set service_type_fields = function('get_fields', 'term_' ~ service_type.id) %}
                                {% if service_type_fields.linked_page is not empty %}
                                <a href="{{ service_type_fields.linked_page  }}" class="text-sm text-md-base service-listing__read-more">
                                    {{ __('More on', 'Expedition') }} {{ title }} {{ 'service' in title ?: __('services' , 'expedition') }}
                                    {{ fetch_svg('chevron-right') }}
                                </a>
                                {% endif %}

                            </div>
                        {% endif %}

                        {% if service_type.posts is array %}
                            {% for service in service_type.posts %}
                                <div class="col-12 col-md-6 col-xl-4">
                                    {% include "partial/card.twig" with {
                                        id : service.ID,
                                        image : function('get_the_post_thumbnail_url', service.ID),
                                        title : service.post_title,
                                        content: service.post_excerpt,
                                        url : get_link(service.ID),
                                        customClass : ' service-listing__card'
                                    } %}
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                {% endfor %}

                {% if certi_services is array %}
                    <div class="row service-listing__row" id="certification_services">
                        <div class="col-12 d-flex justify-content-between align-items-center mb-6 mb-md-8">
                            <h2 class="text-xl text-md-3xl service-listing__title">
                                {{ fetch_svg('medal') }}
                                {{ __('Certification services' , 'expedition') }}
                            </h2>

                            {% if options.certification_service is not empty %}
                                <a href="{{ options.certification_service.url }}" title="{{ options.certification_service.title }}" target="{{ options.certification_service.target }}" class="service-listing__read-more">
                                    {{ __('More on Certification services', 'Expedition') }}
                                    {{ fetch_svg('chevron-right') }}
                                </a>
                            {% endif %}
                        </div>
                        {% for certi_service in certi_services %}
                            <div class="col-12 col-md-6 col-xl-4">
                                {% include "partial/card.twig" with {
                                    id : certi_service.ID,
                                    image : function('get_the_post_thumbnail_url', certi_service.ID),
                                    title : certi_service.post_title,
                                    content: certi_service.post_excerpt,
                                    url : get_link(certi_service.ID),
                                    customClass : ' service-listing__card'
                                } %}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
